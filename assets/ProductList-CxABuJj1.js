import{r as t,M as p,j as e,e as j}from"./index-iZOJl_tw.js";import{a as N}from"./productService-BZEhl7tf.js";import{P as v}from"./Pagination-xZVpJYki.js";import{a as w}from"./cartService-CzVzd8MA.js";import{S as b}from"./sweetalert2.esm.all-BQxta0Da.js";const y=t.forwardRef((g,x)=>{const[s,u]=t.useState(null),[m,n]=t.useState(1),[h,o]=t.useState(!1),[c,a]=t.useState(""),l=t.useRef(null),i=t.useRef(null);t.useEffect(()=>{i.current=new p(l.current,{backdrop:"static"})},[]),t.useImperativeHandle(x,()=>({show:r=>{u(r),n(1),a(r.imageUrl),i.current.show()},hide:()=>{i.current.hide()}}));const f=async()=>{if(s){o(!0);try{await w(s.id,m),i.current.hide(),b.fire({icon:"success",title:"加入購物車成功",showConfirmButton:!1,timer:1500})}catch(r){b.fire({icon:"error",title:"加入購物車失敗",text:r.response?.data?.message||"發生錯誤"})}finally{o(!1)}}};return s?e.jsx("div",{id:"productUserModal",ref:l,className:"modal fade",tabIndex:"-1","aria-labelledby":"productUserModalLabel","aria-hidden":"true",children:e.jsxs("div",{className:"modal-dialog modal-lg",children:[e.jsxs("div",{className:"modal-content border-0 shadow-lg",children:[e.jsxs("div",{className:"modal-header border-bottom-0 p-4 pb-0",children:[e.jsx("span",{className:"badge bg-light text-dark fs-6",children:s.category}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>i.current.hide(),"aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body p-4",children:[e.jsx("div",{className:"row g-4 mb-4",children:e.jsx("div",{className:"col-12",children:e.jsx("h2",{className:"display-6 fw-bold",children:s.title})})}),e.jsxs("div",{className:"row g-4 d-flex align-items-center",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"ratio ratio-1x1 bg-light rounded shadow-sm overflow-hidden position-relative",children:c?e.jsx("img",{src:c,className:"img-fluid object-fit-cover w-100 h-100",alt:s.title}):e.jsx("div",{className:"h-100 w-100 bg-secondary d-flex align-items-center justify-content-center",style:{minHeight:"300px"},children:e.jsx("span",{className:"text-white",children:"無圖片"})})})}),e.jsxs("div",{className:"col-md-6 d-flex flex-column",children:[e.jsxs("div",{className:"d-flex align-items-end mb-4",children:[s.origin_price!==s.price&&e.jsx("div",{className:"me-3",children:e.jsxs("small",{className:"text-muted text-decoration-line-through",children:["原價 NT$ ",s.origin_price]})}),e.jsx("div",{children:e.jsxs("h3",{className:"text-danger fw-bold mb-0",children:["NT$ ",s.price]})})]}),e.jsxs("div",{className:"p-3 bg-light rounded mb-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("label",{htmlFor:"qtySelect",className:"form-label me-3 mb-0 fw-bold",children:"數量"}),e.jsx("select",{id:"qtySelect",className:"form-select w-auto",value:m,onChange:r=>n(Number(r.target.value)),children:[...Array(10)].map((r,d)=>e.jsx("option",{value:d+1,children:d+1},d+1))})]}),e.jsx("button",{className:"btn btn-primary w-100 py-2 fw-bold shadow-sm",type:"button",onClick:f,children:"加入購物車"})]}),s.imagesUrl&&s.imagesUrl.length>0&&e.jsxs("div",{className:"d-flex gap-2 overflow-auto",children:[s.imageUrl&&e.jsx("div",{className:`ratio ratio-1x1 border rounded cursor-pointer ${c===s.imageUrl?"border-primary border-2":"border-light"}`,style:{width:"80px",height:"80px",cursor:"pointer"},onClick:()=>a(s.imageUrl),children:e.jsx("img",{src:s.imageUrl,className:"img-fluid object-fit-cover",alt:"Main"})}),s.imagesUrl.map((r,d)=>r&&e.jsx("div",{className:`ratio ratio-1x1 border rounded cursor-pointer ${c===r?"border-primary border-2":"border-light"}`,style:{width:"80px",height:"80px",cursor:"pointer"},onClick:()=>a(r),children:e.jsx("img",{src:r,className:"img-fluid object-fit-cover",alt:`Thumb ${d+1}`})},d))]})]})]}),e.jsx("div",{className:"row g-4 mt-2",children:e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"fw-bold mb-2",children:"產品描述"}),e.jsx("p",{className:"text-muted",style:{lineHeight:"1.8",whiteSpace:"pre-wrap"},children:s.description})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"fw-bold mb-2",children:"商品內容"}),e.jsx("div",{className:"bg-light p-3 rounded",children:e.jsx("p",{className:"mb-0 text-dark",style:{whiteSpace:"pre-wrap"},children:s.content})})]})]})})]})]}),h&&e.jsx(j,{})]})}):e.jsx("div",{id:"productUserModal",ref:l,className:"modal fade",tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsx("div",{className:"modal-content"})})})}),I=()=>{const[g,x]=t.useState([]),[s,u]=t.useState({}),[m,n]=t.useState(!1),h=t.useRef(null);t.useEffect(()=>{o()},[]);const o=async(a=1)=>{n(!0);try{const l=await N(a);x(l.products),u(l.pagination),setTimeout(()=>{const i=document.querySelector(".container.mt-4");i&&i.scrollIntoView({behavior:"smooth",block:"start"})},0)}catch(l){b.fire({icon:"error",title:"取得產品失敗",text:l.response?.data?.message||"發生錯誤"})}finally{n(!1)}},c=a=>{h.current.show(a)};return e.jsxs(e.Fragment,{children:[m&&e.jsx(j,{}),e.jsxs("div",{className:"container mt-4",children:[e.jsx("div",{className:"d-flex justify-content-between mb-4",children:e.jsx("h2",{children:"產品列表"})}),e.jsx("div",{className:"row mt-4",children:g.map(a=>e.jsx("div",{className:"col-md-6 mb-6",children:e.jsxs("div",{className:"card h-100 shadow-sm border-0",children:[e.jsx("div",{className:"position-relative",style:{height:"250px",overflow:"hidden"},children:a.imageUrl?e.jsx("img",{src:a.imageUrl,className:"card-img-top h-100 w-100",style:{objectFit:"cover"},alt:a.title}):e.jsx("div",{className:"h-100 w-100 bg-secondary d-flex align-items-center justify-content-center",children:e.jsx("span",{className:"text-white",children:"無圖片"})})}),e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("h5",{className:"card-title text-truncate mb-0",style:{maxWidth:"70%"},children:a.title}),e.jsx("span",{className:"badge bg-secondary",children:a.category})]}),e.jsx("p",{className:"card-text text-muted small mb-auto",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:a.description}),e.jsx("div",{className:"d-flex justify-content-between align-items-center mt-3",children:e.jsxs("div",{children:[a.origin_price!==a.price&&e.jsxs("small",{className:"text-decoration-line-through text-muted me-2",children:["$",a.origin_price]}),e.jsxs("span",{className:"fw-bold text-danger",children:["$",a.price]})]})})]}),e.jsx("div",{className:"card-footer bg-transparent border-top-0 d-flex justify-content-between pb-3",children:e.jsx("button",{type:"button",className:"btn btn-outline-primary w-100",onClick:()=>c(a),children:"詳細資料"})})]})},a.id))}),e.jsx(v,{currentPage:s.current_page,totalPages:s.total_pages,onPageChange:o}),e.jsx(y,{ref:h})]})]})};export{I as default};
