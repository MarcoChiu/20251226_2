import{r as n,j as t,e as w}from"./index-DVyv32AZ.js";import{g as y,u as N,c as _,d as C}from"./productService-BQcXcqnr.js";import{P as M}from"./Pagination-nYRCMy6R.js";import{P as v,a as D}from"./ProductDModal-ffJrle5R.js";import{P as R}from"./ProductCard-CPm-Bhoa.js";import{s as l,a as u}from"./sweetAlert-D4ArfHHU.js";import{s as k}from"./scrollTo-BJ3PFdU1.js";const A=()=>{const[m,f]=n.useState([]),[s,g]=n.useState({}),[h,a]=n.useState(!1),c=n.useRef(null),d=n.useRef(null);n.useEffect(()=>{o()},[]);const o=async(e=1,r=!0)=>{a(!0);try{const i=await y(e);f(i.products),g(i.pagination),r&&k()}catch(i){l("error","取得產品失敗",i.response?.data?.message||"發生錯誤")}finally{a(!1)}},P=async e=>{a(!0);try{const r={...e,origin_price:Number(e.origin_price),price:Number(e.price)};await _(r),c.current.hide(),await o(s.current_page,!1),u("success","新增成功")}catch(r){l("error","新增失敗",r.response?.data?.message||"發生錯誤")}finally{a(!1)}},x=async e=>{a(!0);try{const r={...e,origin_price:Number(e.origin_price),price:Number(e.price)};await N(e.id,r),c.current.hide(),await o(s.current_page,!1),u("success","更新成功")}catch(r){l("error","更新失敗",r.response?.data?.message||"發生錯誤")}finally{a(!1)}},b=async e=>{a(!0);try{await C(e.id),d.current.hide(),m.length===1&&s.current_page>1?await o(s.current_page-1,!1):await o(s.current_page,!1),u("success","刪除成功")}catch(r){l("error","刪除失敗",r.response?.data?.message||"發生錯誤")}finally{a(!1)}},p=(e,r)=>{c.current.show(e,r)},j=e=>{d.current.show(e)};return t.jsxs(t.Fragment,{children:[h&&t.jsx(w,{}),t.jsxs("div",{className:"container mt-4",children:[t.jsxs("div",{className:"d-flex justify-content-between mb-4",children:[t.jsx("h2",{children:"產品列表"}),t.jsx("div",{children:t.jsx("button",{className:"btn btn-primary me-2",onClick:()=>p("create"),children:"建立產品"})})]}),t.jsx("div",{className:"row mt-4",children:m.map(e=>t.jsx("div",{className:"col-md-6 mb-6",children:t.jsxs(R,{product:e,showStatus:!0,children:[t.jsx("button",{type:"button",className:"btn btn-outline-primary w-50 me-2",onClick:()=>p("edit",e),children:"編輯"}),t.jsx("button",{type:"button",className:"btn btn-outline-danger w-50",onClick:()=>j(e),children:"刪除"})]})},e.id))}),t.jsx(M,{currentPage:s.current_page,totalPages:s.total_pages,onPageChange:o}),t.jsx(v,{ref:c,onCreate:P,onUpdate:x}),t.jsx(D,{ref:d,onDelete:b})]})]})};export{A as default};
